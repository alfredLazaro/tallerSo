BACI System: C-- to PCODE Compiler, 12:29  18 Jul 2004
Source file: C:\jbaci\examples\trabajoGrup\pruebAdri\ejemplo2.cm  Sun Oct 24 19:37:38 2021
 line  pc
   1    0  semaphore acceso=1; //puerta
   2    0  semaphore adminIN=1; //administrador
   3    0  semaphore estSale=0;
   4    0  int adminAdentro=0;
   5    0  int habVacia=0;
   6    0  int cantEst=0;
   7    0  int cantMax=2;//varia
   8    0  int numRandom;
   9    0  int terminaFiesta=0;// no es seguro
  10    0  int votarEst=0;
  11    0  void estudiante(int id){
  12    0  int x=0;
  13    3                 
  14    3  		wait(acceso);
  15    5  		
  16    5  		cout<<"Intenta ingresar Estudiante"<<id<<endl;
  17    9  		if(adminAdentro==1){
  18   13  			cout<<"Acceso denegado Estudiante  "<<id<<endl;
  19   17    
  20   17  			signal(acceso);
  21   19  			
  22   19  			}else{  
  23   20  				cout<<"Entra Estudiante "<<id <<" a la habitacion"<<'\n';
  24   26  				votarEst=0;
  25   29  				habVacia=1;
  26   32  				cantEst++;
  27   37  				cout<<"Hay " <<cantEst<< " estudiantes"<<'\n';
  28   43  				signal(acceso);
  29   45                               }
  30   45  //fuera de else
  31   45                       
  32   45                                
  33   45  			
  34   45  				wait(acceso);  //no detiene al proceso un estudiante puede salir sin entrar
  35   47  				if(cantEst>0){
  36   51  					cout<<"Sale Estudiante "<<id <<" de la habitacion"<<'\n';
  37   57  					cantEst--;
  38   62  					cout<<"Hay " <<cantEst<< " estudiantes"<<'\n';
  39   68  					if(cantEst==0){
  40   72  						habVacia=0; //administrador pueda entrar
  41   75  						cout<<"Salieron todos los estudiantes"<<'\n';
  42   78  						adminAdentro=0;
  43   81  					}
  44   81                                  }
  45   81  signal(acceso);
  46   83  }
  47   84  void administrador(int id){
  48   84   while(1){
  49   86                     wait(acceso);
  50   88  if(adminAdentro==0){
  51   92  		    cout<<"	Administrador "<<id<<" intenta ingresar"<<endl;
  52   97  }
  53   97  			if(habVacia==0){
  54  101  				if(adminAdentro==0){
  55  105  				cout<<"      Entra Administrador"<<id<<endl;
  56  109  				}
  57  109  				cout<<"      Revisa Administrador"<<id<<endl;				
  58  113  				cout<<"      SALE Administrador"<<id<<endl;	
  59  117                           }else if(cantEst >= cantMax){
  60  122  				if(adminAdentro==0){
  61  126  				cout<<"      Entra Administrador"<<id<<" logra ingresar"<<endl;
  62  131  				cout<<"      Termina la fiesta Administrador"<<id<<endl;	
  63  135  				} 
  64  135  				cout<<"	     revisa la habitacion"<<id<<'\n';
  65  140  				adminAdentro=1;
  66  143                                  signal(acceso);
  67  145  				
  68  145                                }else{ 
  69  146  				cout<<"      Administrador "<<id<<" acceso denegado"<<endl;
  70  151                                }
  71  151  		  signal(acceso);
  72  153   }   
  73  154  }
  74  155  void main(){
  75  156     cobegin{
  76  157  		administrador(99);
  77  161                  estudiante(1);estudiante(2);estudiante(3);estudiante(4);estudiante(5);
  78  181  		estudiante(6);estudiante(8);estudiante(9);
  79  193  		
  80  193       }
  81  194  }
